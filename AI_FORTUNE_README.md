# AI生成総合運勢の実装

## 概要
このバージョンでは、Claude APIを使用して、占い結果に基づいた説得力のある総合運勢を動的に生成します。

## 特徴

### ✨ AI生成の総合運勢
- 8種類の占術結果を分析
- 400-600文字の説得力のある文章を生成
- パーソナライズされた具体的なアドバイス
- 前向きで励ましのあるメッセージ

### 🔄 フォールバック機能
APIエラー時は自動的にデフォルトの文章に切り替わります

### ⏱️ ローディング表示
AI生成中は「🔮 AI が総合運勢を鑑定中...」と表示

## 動作の流れ

1. ユーザーが生年月日を入力
2. 8種類の占術が実行される
3. 占い結果がClaude APIに送信される
4. AIが占い結果を分析して総合運勢を生成
5. 生成された文章が表示される

## 生成される内容

AIは以下の要素を含む総合運勢を生成します：

- **占術の共通点分析**: 複数の占術結果から見える共通の傾向
- **2026年の展望**: 具体的な運勢の予測
- **実践的アドバイス**: すぐに実行できる行動指針
- **励ましのメッセージ**: 前向きに進むためのエール

## 生成例

```
あなたの九星気学「三碧木星」と運命数「5」は、共に「変化」と「成長」
というテーマを強く持っています。西洋占星術の双子座の柔軟性と、
五星三心の金のカメレオンの適応力が組み合わさることで、2026年は
あなたにとって大きな飛躍の年となるでしょう。

特に春から夏にかけては、新しい出会いやチャンスが次々と訪れます。
恐れずに一歩踏み出すことで、思いがけない展開が待っています。
ただし、変化を楽しみながらも、自分の軸はしっかりと保つことが大切です。

秋以降は、これまでの経験を統合する時期。あなたの多様な才能を
活かせる場面が増え、周囲からの信頼も厚くなります。直感を信じて
行動することで、大きな成功を手にすることができるでしょう。

2026年は、あなたらしさを最大限に発揮できる一年です。自分を信じて、
ワクワクする方向へ進んでいってください！
```

## 技術的な詳細

### API呼び出し
```javascript
const response = await fetch("https://api.anthropic.com/v1/messages", {
    method: "POST",
    headers: {
        "Content-Type": "application/json",
    },
    body: JSON.stringify({
        model: "claude-sonnet-4-20250514",
        max_tokens: 1000,
        messages: [
            { role: "user", content: prompt }
        ],
    })
});
```

### プロンプト設計
- 占い師としてのペルソナ設定
- 占い結果の詳細情報を提供
- 具体的な要件を明示
- 文字数制限を指定

## 注意事項

- Claude APIは無料で利用可能（claude.ai環境内）
- API認証は自動で処理されるため、APIキーは不要
- エラー発生時は自動的にデフォルトメッセージにフォールバック

## カスタマイズ

プロンプトを編集することで、以下のようなカスタマイズが可能です：

- 文体の変更（カジュアル/フォーマル）
- 文字数の調整
- 特定の要素の強調（恋愛運、仕事運など）
- 季節ごとのアドバイス追加

## 今後の拡張案

- タロットや紫微斗数の結果も総合運勢に含める
- 月ごとの運勢も生成
- ユーザーの質問に答える対話機能
- 過去の占い結果と比較する機能
